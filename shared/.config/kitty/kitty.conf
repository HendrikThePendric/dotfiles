# ============================================
# KITTY TERMINAL CONFIGURATION
# Configured for tmux 3.6a compatibility
# Last updated: 04-02-2026
# ============================================

# ------------------------------------------------------------------
# THEME & VISUAL SETTINGS
# ------------------------------------------------------------------

# Catppuccin Mocha theme - applied first so custom settings can override
# BEGIN_KITTY_THEME
include catppuccin-mocha.conf
# END_KITTY_THEME

# ------------------------------------------------------------------
# TERMINAL BEHAVIOR & INTEGRATION
# ------------------------------------------------------------------

# Enable remote control via UNIX socket
# Allows tools like "kitty @ ls" to control running instances
allow_remote_control yes

# Increase scrollback buffer (default is 2000 lines)
# Useful for viewing long command outputs
scrollback_lines 10000

# Disable confirmation dialog when closing windows with unsaved content
# Set to 1 if you want prompts before closing
confirm_os_window_close 0

# Enable modern terminal features and shell integration
# Improves prompt detection, working directory tracking, etc.
shell_integration enabled

# ------------------------------------------------------------------
# TERMINAL EMULATION & KEYBOARD
# ------------------------------------------------------------------

# Set terminal type to Kitty's enhanced xterm emulation
# Required for proper feature detection in tmux and other programs
term xterm-kitty

# Disable terminal bell sounds (visual bell still works)
enable_audio_bell no

# ------------------------------------------------------------------
# CRITICAL: KEYBOARD FIXES FOR TMUX COMPATIBILITY
# ------------------------------------------------------------------

# Force Kitty to send proper escape sequences for modified keys
# Without this, tmux won't recognize Shift+Enter as distinct from Enter
# Sequence \x1b[13;2u: ESC[ + keycode 13 (Enter) + ;2 (Shift modifier) + u
map shift+enter send_text all \x1b[13;2u
map shift+KP_enter send_text all \x1b[13;2u

# ------------------------------------------------------------------
# CLIPBOARD INTEGRATION
# ------------------------------------------------------------------

# Full clipboard control for OSC 52 protocol support
# This allows terminal apps (like tmux, nvim) to read/write system clipboard
# write-clipboard: Apps can write to system clipboard
# read-clipboard: Apps can read from system clipboard
# write-primary/read-primary: X11 primary selection support
clipboard_control write-clipboard write-primary read-clipboard read-primary

# ------------------------------------------------------------------
# KEYBINDINGS & SHORTCUTS
# ------------------------------------------------------------------

# Search through scrollback buffer (like tmux copy mode)
# Press Ctrl+Shift+F, type search term, Enter to exit
map ctrl+shift+f show_scrollback

# ------------------------------------------------------------------
# HOST-SPECIFIC OVERRIDES
# ------------------------------------------------------------------

# Load machine-specific settings (font sizes, window positions, etc.)
# This file should be symlinked from host-specific directory
include kitty.conf.local

# ------------------------------------------------------------------
# TROUBLESHOOTING & VERIFICATION
# ------------------------------------------------------------------
# To test if Shift+Enter is working:
# 1. Run: kitty +kitten show_key
# 2. Press Shift+Enter
# 3. Should show: "shifted enter" with bytes: 27 91 49 51 59 50 117
#
# To check terminal type inside programs:
# 1. Run: echo $TERM
# 2. Should show: xterm-kitty (outside tmux) or tmux-256color (inside tmux)
#
# If clipboard doesn't work with tmux/nvim:
# 1. Verify clipboard_control includes write-clipboard
# 2. Check if Kitty has clipboard permission (macOS may need authorization)
#
# To reload config without restarting Kitty:
# 1. Press: Ctrl+Shift+F5
# 2. Or run: kitty @ set-colors --all ~/.config/kitty/kitty.conf
# ------------------------------------------------------------------